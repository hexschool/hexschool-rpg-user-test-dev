import{v as y,D as C,f as E,r as f,o as F,c as L,a as s,l,w as v,j as p,E as P,G as z,b as A,n as _,m as w,p as m,H as q,i as N}from"./index.05d1aa2e.js";const Z={class:"col-md-8"},G=s("h1",{class:"fs-4 mb-3"},"\u500B\u4EBA\u8CC7\u8A0A",-1),T={class:"border rounded-4 p-6"},B={class:"row"},j={class:"col-md-6"},H={class:"mb-3"},O=s("label",{for:"nickname",class:"form-label"},"\u66B1\u7A31",-1),R=["disabled"],I=s("hr",null,null,-1),J=s("div",{class:"mb-3 visually-hidden"},[s("label",{for:"username",class:"form-label"},"Username"),s("input",{id:"username",type:"text",class:"form-control",name:"username",autocomplete:"username"})],-1),K={class:"mb-3"},Q=s("label",{for:"old_password",class:"form-label"},"\u820A\u5BC6\u78BC",-1),W={class:"mb-3"},X=s("label",{for:"new_password",class:"form-label"},"\u65B0\u5BC6\u78BC",-1),Y={class:"mb-3"},ss=s("label",{for:"confirm_new_password",class:"form-label"},"\u78BA\u8A8D\u65B0\u5BC6\u78BC",-1),es=["disabled"],as=s("hr",null,null,-1),os={class:"mb-3"},ts=s("label",{for:"email",class:"form-label"},"Email",-1),ls={class:"mb-3"},ds=s("label",{for:"teachableEmail",class:"form-label"},"Teachable \u767B\u5165 ",-1),is={class:"d-grid"},ns=["value","disabled"],rs=A('<div class="mb-3"><label for="githubLogin" class="form-label">GitHub \u767B\u5165</label><div class="d-grid"><input type="button" class="btn btn-primary" id="githubLogin" value="\u9023\u7D50"></div></div><div class="mb-3"><label for="googleLogin" class="form-label">Google \u767B\u5165</label><div class="d-grid"><input type="button" class="btn btn-primary" id="googleLogin" value="\u9023\u7D50"></div></div><hr>',3),cs={class:"row"},ms={class:"col-md-8"},us={class:"mb-3"},ps=s("label",{for:"description",class:"form-label"},"\u500B\u4EBA\u7C21\u4ECB",-1),_s=["disabled"],ws={__name:"UserProfile",props:{userData:{type:Object,default(){return{}}}},emits:["update:getUserData"],setup(V,{emit:b}){const h=V,{apiPutUserNickname:k,apiPutUserPassword:U,apiPutUserDescription:M}=q,{apiGetLoginTeachable:D}=N,d=y({thirdparty:[{}]});C(()=>h.userData,()=>{d.value=h.userData});const r=y({}),x=w(async()=>{var i,a,o,t;try{const e={nickname:d.value.nickname};await k(e),b("update:getUserData"),m.toastMessage("success","","\u66F4\u65B0\u6210\u529F")}catch(e){m.toastMessage("danger","info",`${(a=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:a.statusCode}:${(t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message}`)}}),S=w(async()=>{var i,a,o,t;try{const e={old_password:r.value.old_password,new_password:r.value.new_password,confirm_new_password:r.value.confirm_new_password};await U(e),b("update:getUserData"),m.toastMessage("success","","\u66F4\u65B0\u6210\u529F")}catch(e){m.toastMessage("danger","info",`${(a=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:a.statusCode}:${(t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message}`)}}),$=w(async()=>{var i,a,o,t;try{const e={description:d.value.description};await M(e),b("update:getUserData"),m.toastMessage("success","","\u66F4\u65B0\u6210\u529F")}catch(e){m.toastMessage("danger","info",`${(a=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:a.statusCode}:${(t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message}`)}}),g=w(async()=>{const i={redirectType:"user"},a=new URLSearchParams(i).toString(),o=await D(a);window.location.href=o.redirect_url});return E(()=>{b("update:getUserData")}),(i,a)=>{const o=f("VField"),t=f("ErrorMessage"),e=f("VForm");return F(),L("div",Z,[G,s("div",T,[s("div",B,[s("div",j,[l(e,{ref:"nicknameForm",onSubmit:p(x)},{default:v(({errors:n,meta:u})=>[s("div",H,[O,l(o,{id:"nickname",modelValue:d.value.nickname,"onUpdate:modelValue":a[0]||(a[0]=c=>d.value.nickname=c),modelModifiers:{trim:!0},name:"nickname",label:"\u66B1\u7A31",type:"text",class:_(["form-control",{"is-invalid":n.nickname}]),rules:{required:!0,regex:/^[a-zA-Z0-9\u4e00-\u9fa5_-][a-zA-Z0-9 \u4e00-\u9fa5_-]{0,18}[a-zA-Z0-9\u4e00-\u9fa5_-]$/}},null,8,["modelValue","class"]),l(t,{name:"nickname",class:"invalid-feedback"})]),s("button",{type:"submit",class:"btn btn-primary",disabled:!u.valid}," \u78BA\u8A8D\u4FEE\u6539 ",8,R)]),_:1},8,["onSubmit"]),I,l(e,{ref:"passwordForm",onSubmit:p(S)},{default:v(({errors:n,meta:u})=>[J,s("div",K,[Q,l(o,{id:"old_password",modelValue:r.value.old_password,"onUpdate:modelValue":a[1]||(a[1]=c=>r.value.old_password=c),modelModifiers:{trim:!0},name:"old_password",label:"\u820A\u5BC6\u78BC",type:"password",class:_(["form-control",{"is-invalid":n.old_password}]),rules:"required",autocomplete:"current-password"},null,8,["modelValue","class"]),l(t,{name:"old_password",class:"invalid-feedback"})]),s("div",W,[X,l(o,{id:"new_password",modelValue:r.value.new_password,"onUpdate:modelValue":a[2]||(a[2]=c=>r.value.new_password=c),modelModifiers:{trim:!0},name:"new_password",type:"password",label:"\u65B0\u5BC6\u78BC",class:_(["form-control",{"is-invalid":n.new_password}]),rules:{required:!0,regex:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,16}$/},autocomplete:"new-password"},null,8,["modelValue","class","rules"]),l(t,{name:"new_password",class:"invalid-feedback"})]),s("div",Y,[ss,l(o,{id:"confirm_new_password",modelValue:r.value.confirm_new_password,"onUpdate:modelValue":a[3]||(a[3]=c=>r.value.confirm_new_password=c),modelModifiers:{trim:!0},name:"confirm_new_password",type:"password",label:"\u78BA\u8A8D\u65B0\u5BC6\u78BC",class:_(["form-control",{"is-invalid":n.confirm_new_password}]),rules:"required|confirmed:@new_password",autocomplete:"new-password"},null,8,["modelValue","class"]),l(t,{name:"confirm_new_password",class:"invalid-feedback"})]),s("button",{type:"submit",class:"btn btn-primary",disabled:!u.valid}," \u78BA\u8A8D\u4FEE\u6539 ",8,es)]),_:1},8,["onSubmit"]),as,s("div",os,[ts,P(s("input",{type:"email","onUpdate:modelValue":a[4]||(a[4]=n=>d.value.email=n),class:"form-control",id:"email",disabled:""},null,512),[[z,d.value.email]])]),s("div",ls,[ds,s("div",is,[s("input",{type:"button",class:"btn btn-primary",id:"teachableEmail",value:d.value.thirdparty[0].email?"\u5DF2\u9023\u7D50":"\u9023\u7D50",disabled:d.value.thirdparty[0].email,onClick:a[5]||(a[5]=(...n)=>p(g)&&p(g)(...n))},null,8,ns)])]),rs])]),s("div",cs,[s("div",ms,[l(e,{ref:"descriptionForm",onSubmit:p($)},{default:v(({errors:n,meta:u})=>[s("div",us,[ps,l(o,{id:"description",as:"textarea",modelValue:d.value.description,"onUpdate:modelValue":a[6]||(a[6]=c=>d.value.description=c),modelModifiers:{trim:!0},label:"\u500B\u4EBA\u7C21\u4ECB",name:"description",class:_(["form-control",{"is-invalid":n.description}]),rows:"4",placeholder:"\u8ACB\u8F38\u5165\u4F60\u7684\u500B\u4EBA\u7C21\u4ECB\uFF0C\u5B57\u6578\u9650\u5236 500 \u5B57",rules:"required|max:500"},null,8,["modelValue","class"]),l(t,{name:"description",class:"invalid-feedback"})]),s("button",{type:"submit",class:"btn btn-primary",disabled:!u.valid}," \u78BA\u8A8D\u4FEE\u6539 ",8,_s)]),_:1},8,["onSubmit"])])])])])}}};export{ws as default};
